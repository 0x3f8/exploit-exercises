**Intro**

Level 14 introduces a binary file, *flag14*, which encrypts a file.  It's strongly implied that this binary was used to encrypt the contents of the token file.

The first order of business to to try to determine how the application encrypts a couple of simple strings.  First I'll try with numbers, and then with alpha characters.

**Encrypt 0-9**

```
﻿level14@nebula:/home/flag14$ echo 0123456789 | ./flag14 -e
02468:<>@Blevel14@nebula:/home/flag14$ 
```

**Encrypt Some Text**

```
﻿level14@nebula:/home/flag14$ echo abcdefghijklmnoABCEDFGHIJKLMNO | ./flag14 -e
acegikmoqsuwy{}PRTWWZ\^`bdfhjl(level14@nebula:/home/flag14$
```

Looking at the pattern, it appears to be a simple progression of adding the index position, starting with 0, to the decimal value of the alphanumeric character.

As an example

```
Position:   0   1   2 ... 9
            v   v   v     v
Character:  0   1   2     9
            v   v   v     v 
Decimal:    48  49  50    57  
            v   v   v     v
Encrypted:  48  50  52    66 (Decimal value + position)
            v   v   v     v
Character:  0   2   4     B
```

Given this pattern I wrote a [perl script](../resources/decrypt_level14.pl) to decrypt the text.  It takes the file name as an input, iterates through the characters, and adds the index value to the decimal value.  Finally it outputs the decrypted string.

**Script in Action**

```
﻿level14@nebula:/home/flag14$ cat token 
857:g67?5ABBo:BtDA?tIvLDKL{MQPSRQWW.

﻿level14@nebula:/home/flag14$ ~/decrypt.pl token 
8457c118-887c-4e40-a5a6-33a25353165
```

**Flag time**

```
﻿level14@nebula:/home/flag14$ su - flag14
Password: 
flag14@nebula:~$ getflag
You have successfully executed getflag on a target account
```

